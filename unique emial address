#include <stdio.h>
#include <stdlib.h>
#include <string.h>

#define MAX_LEN 100

char* normalizeEmail(const char* email) {
    char* normalized = (char*)malloc(MAX_LEN);
    int i = 0, j = 0;
    int ignore = 0;

    while (email[i] != '\0' && email[i] != '@') {
        if (email[i] == '+') {
            ignore = 1;
        } else if (!ignore && email[i] != '.') {
            normalized[j++] = email[i];
        }
        i++;
    }

    while (email[i] != '\0') {
        normalized[j++] = email[i++];
    }

    normalized[j] = '\0';
    return normalized;
}

int numUniqueEmails(char** emails, int emailsSize) {
    char* uniqueEmails[emailsSize];
    int uniqueCount = 0;

    for (int i = 0; i < emailsSize; i++) {
        char* normalized = normalizeEmail(emails[i]);
        int exists = 0;

        for (int j = 0; j < uniqueCount; j++) {
            if (strcmp(normalized, uniqueEmails[j]) == 0) {
                exists = 1;
                break;
            }
        }

        if (!exists) {
            uniqueEmails[uniqueCount++] = normalized;
        } else {
            free(normalized);
        }
    }

    for (int i = 0; i < uniqueCount; i++) {
        free(uniqueEmails[i]);
    }

    return uniqueCount;
}
