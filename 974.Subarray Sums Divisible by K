#include <stdio.h>
#include <stdlib.h>
#include <string.h>


int subarraysDivByK(int* nums, int numsSize, int k) {
    
    int* remainder_counts = (int*)calloc(k, sizeof(int));
    if (remainder_counts == NULL) {
        return 0;
    }

    
    remainder_counts[0] = 1;

    int prefix_sum_mod_k = 0;
    int count = 0;

    for (int i = 0; i < numsSize; i++) {
       
        prefix_sum_mod_k = prefix_sum_mod_k + nums[i];

        
        prefix_sum_mod_k = prefix_sum_mod_k % k;
        if (prefix_sum_mod_k < 0) {
            prefix_sum_mod_k += k;
        }

      
        count += remainder_counts[prefix_sum_mod_k];

        
        remainder_counts[prefix_sum_mod_k]++;
    }

    free(remainder_counts);
    return count;
}
